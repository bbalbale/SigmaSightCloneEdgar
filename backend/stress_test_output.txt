warning: `VIRTUAL_ENV=C:\Users\BenBalbale\CascadeProjects\SigmaSight\.venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead

================================================================================
RUNNING STRESS TESTING FOR ALL DEMO PORTFOLIOS
================================================================================
2025-10-14 22:20:04,860 INFO sqlalchemy.engine.Engine select pg_catalog.version()
2025-10-14 22:20:04,860 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-10-14 22:20:04,863 INFO sqlalchemy.engine.Engine select current_schema()
2025-10-14 22:20:04,863 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-10-14 22:20:04,866 INFO sqlalchemy.engine.Engine show standard_conforming_strings
2025-10-14 22:20:04,866 INFO sqlalchemy.engine.Engine [raw sql] ()
2025-10-14 22:20:04,868 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-10-14 22:20:04,918 INFO sqlalchemy.engine.Engine SELECT portfolios.id, portfolios.user_id, portfolios.name, portfolios.description, portfolios.currency, portfolios.equity_balance, portfolios.created_at, portfolios.updated_at, portfolios.deleted_at 
FROM portfolios JOIN users ON users.id = portfolios.user_id 
WHERE users.email IN ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR)
2025-10-14 22:20:04,918 INFO sqlalchemy.engine.Engine [generated in 0.00027s] ('demo_individual@sigmasight.com', 'demo_hnw@sigmasight.com', 'demo_hedgefundstyle@sigmasight.com')

Found 3 demo portfolios

================================================================================
Portfolio: Demo Individual Investor Portfolio
ID: 1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe
================================================================================
Running comprehensive stress test...
2025-10-14 22:20:04,925 INFO sqlalchemy.engine.Engine SELECT market_data_cache.symbol, market_data_cache.date, market_data_cache.close 
FROM market_data_cache 
WHERE market_data_cache.symbol IN ($3::VARCHAR, $4::VARCHAR, $5::VARCHAR, $6::VARCHAR, $7::VARCHAR, $8::VARCHAR, $9::VARCHAR) AND market_data_cache.date >= $1::DATE AND market_data_cache.date <= $2::DATE ORDER BY market_data_cache.date, market_data_cache.symbol
2025-10-14 22:20:04,925 INFO sqlalchemy.engine.Engine [generated in 0.00032s] (datetime.date(2025, 1, 5), datetime.date(2025, 10, 14), 'SPY', 'VTV', 'VUG', 'MTUM', 'QUAL', 'IWM', 'USMV')
2025-10-14 22:20:04,942 INFO sqlalchemy.engine.Engine SELECT portfolios.id, portfolios.user_id, portfolios.name, portfolios.description, portfolios.currency, portfolios.equity_balance, portfolios.created_at, portfolios.updated_at, portfolios.deleted_at 
FROM portfolios 
WHERE portfolios.id = $1::UUID
2025-10-14 22:20:04,942 INFO sqlalchemy.engine.Engine [generated in 0.00020s] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'),)
2025-10-14 22:20:04,942 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at 
FROM factor_exposures 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE 
 LIMIT $3::INTEGER
2025-10-14 22:20:04,942 INFO sqlalchemy.engine.Engine [generated in 0.00016s] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:04,950 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:04,950 INFO sqlalchemy.engine.Engine [generated in 0.00021s] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:04,954 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:04,955 INFO sqlalchemy.engine.Engine [generated in 0.00033s] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:04,959 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:04,959 INFO sqlalchemy.engine.Engine [cached since 0.008973s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:04,961 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:04,961 INFO sqlalchemy.engine.Engine [cached since 0.00647s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:04,963 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:04,963 INFO sqlalchemy.engine.Engine [cached since 0.01293s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:04,964 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:04,965 INFO sqlalchemy.engine.Engine [cached since 0.01023s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:04,966 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:04,966 INFO sqlalchemy.engine.Engine [cached since 0.0164s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:04,968 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:04,968 INFO sqlalchemy.engine.Engine [cached since 0.01356s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:04,970 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:04,970 INFO sqlalchemy.engine.Engine [cached since 0.02024s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:04,972 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:04,972 INFO sqlalchemy.engine.Engine [cached since 0.01774s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:04,974 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:04,974 INFO sqlalchemy.engine.Engine [cached since 0.02394s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:04,975 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:04,975 INFO sqlalchemy.engine.Engine [cached since 0.02098s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:04,976 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:04,976 INFO sqlalchemy.engine.Engine [cached since 0.02704s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:04,976 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:04,976 INFO sqlalchemy.engine.Engine [cached since 0.02387s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
No exposure found for shocked factor: Interest_Rate (mapped to Interest Rate Beta)
2025-10-14 22:20:04,976 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:04,976 INFO sqlalchemy.engine.Engine [cached since 0.02971s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:04,976 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:04,976 INFO sqlalchemy.engine.Engine [cached since 0.02654s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
No exposure found for shocked factor: Interest_Rate (mapped to Interest Rate Beta)
2025-10-14 22:20:04,982 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:04,982 INFO sqlalchemy.engine.Engine [cached since 0.03237s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:04,982 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:04,982 INFO sqlalchemy.engine.Engine [cached since 0.0293s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:04,982 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:04,982 INFO sqlalchemy.engine.Engine [cached since 0.03536s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:04,987 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:04,988 INFO sqlalchemy.engine.Engine [cached since 0.03282s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
No exposure found for shocked factor: Interest_Rate (mapped to Interest Rate Beta)
2025-10-14 22:20:04,989 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:04,989 INFO sqlalchemy.engine.Engine [cached since 0.0393s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:04,990 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:04,990 INFO sqlalchemy.engine.Engine [cached since 0.03616s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
No exposure found for shocked factor: Interest_Rate (mapped to Interest Rate Beta)
2025-10-14 22:20:04,992 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:04,992 INFO sqlalchemy.engine.Engine [cached since 0.04212s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:04,992 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:04,992 INFO sqlalchemy.engine.Engine [cached since 0.03896s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:04,992 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:04,992 INFO sqlalchemy.engine.Engine [cached since 0.04476s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:04,992 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:04,992 INFO sqlalchemy.engine.Engine [cached since 0.04174s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:04,992 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:04,992 INFO sqlalchemy.engine.Engine [cached since 0.04772s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:04,992 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:04,992 INFO sqlalchemy.engine.Engine [cached since 0.04467s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:04,992 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:04,992 INFO sqlalchemy.engine.Engine [cached since 0.05054s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,002 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,002 INFO sqlalchemy.engine.Engine [cached since 0.0475s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:05,003 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,003 INFO sqlalchemy.engine.Engine [cached since 0.05374s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,005 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,005 INFO sqlalchemy.engine.Engine [cached since 0.05123s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:05,007 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,007 INFO sqlalchemy.engine.Engine [cached since 0.05755s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,009 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,009 INFO sqlalchemy.engine.Engine [cached since 0.05461s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:05,010 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,010 INFO sqlalchemy.engine.Engine [cached since 0.0604s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,011 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,011 INFO sqlalchemy.engine.Engine [cached since 0.05725s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:05,013 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,013 INFO sqlalchemy.engine.Engine [cached since 0.06312s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,014 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,014 INFO sqlalchemy.engine.Engine [cached since 0.0601s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:05,016 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,016 INFO sqlalchemy.engine.Engine [cached since 0.06595s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,017 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,017 INFO sqlalchemy.engine.Engine [cached since 0.06291s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:05,019 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,019 INFO sqlalchemy.engine.Engine [cached since 0.06897s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,021 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,021 INFO sqlalchemy.engine.Engine [cached since 0.06628s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:05,023 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,023 INFO sqlalchemy.engine.Engine [cached since 0.07276s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,023 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,024 INFO sqlalchemy.engine.Engine [cached since 0.06978s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:05,025 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,026 INFO sqlalchemy.engine.Engine [cached since 0.07563s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,027 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,027 INFO sqlalchemy.engine.Engine [cached since 0.07245s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:05,028 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,028 INFO sqlalchemy.engine.Engine [cached since 0.07822s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,029 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,029 INFO sqlalchemy.engine.Engine [cached since 0.07511s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:05,031 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,031 INFO sqlalchemy.engine.Engine [cached since 0.08094s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,032 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,032 INFO sqlalchemy.engine.Engine [cached since 0.07777s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
No exposure found for shocked factor: Interest_Rate (mapped to Interest Rate Beta)
2025-10-14 22:20:05,034 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,034 INFO sqlalchemy.engine.Engine [cached since 0.08374s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,034 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,034 INFO sqlalchemy.engine.Engine [cached since 0.08067s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
No exposure found for shocked factor: Interest_Rate (mapped to Interest Rate Beta)
2025-10-14 22:20:05,036 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,036 INFO sqlalchemy.engine.Engine [cached since 0.08664s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,037 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,037 INFO sqlalchemy.engine.Engine [cached since 0.08398s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:05,037 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,037 INFO sqlalchemy.engine.Engine [cached since 0.09005s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,037 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,037 INFO sqlalchemy.engine.Engine [cached since 0.08693s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
No exposure found for shocked factor: Interest_Rate (mapped to Interest Rate Beta)
2025-10-14 22:20:05,037 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,037 INFO sqlalchemy.engine.Engine [cached since 0.09276s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,043 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,043 INFO sqlalchemy.engine.Engine [cached since 0.08961s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
No exposure found for shocked factor: Interest_Rate (mapped to Interest Rate Beta)
2025-10-14 22:20:05,043 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,043 INFO sqlalchemy.engine.Engine [cached since 0.09552s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,043 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,043 INFO sqlalchemy.engine.Engine [cached since 0.09237s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:05,043 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,043 INFO sqlalchemy.engine.Engine [cached since 0.09813s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,050 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,050 INFO sqlalchemy.engine.Engine [cached since 0.09498s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
No exposure found for shocked factor: Interest_Rate (mapped to Interest Rate Beta)
2025-10-14 22:20:05,050 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,050 INFO sqlalchemy.engine.Engine [cached since 0.1008s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,050 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,050 INFO sqlalchemy.engine.Engine [cached since 0.09767s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
No exposure found for shocked factor: Interest_Rate (mapped to Interest Rate Beta)
2025-10-14 22:20:05,054 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,054 INFO sqlalchemy.engine.Engine [cached since 0.104s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,056 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,056 INFO sqlalchemy.engine.Engine [cached since 0.1014s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:05,058 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,058 INFO sqlalchemy.engine.Engine [cached since 0.1075s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,059 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,059 INFO sqlalchemy.engine.Engine [cached since 0.1044s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
No exposure found for shocked factor: Interest_Rate (mapped to Interest Rate Beta)
2025-10-14 22:20:05,060 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,061 INFO sqlalchemy.engine.Engine [cached since 0.1104s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,062 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,062 INFO sqlalchemy.engine.Engine [cached since 0.1072s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
No exposure found for shocked factor: Interest_Rate (mapped to Interest Rate Beta)
2025-10-14 22:20:05,063 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,063 INFO sqlalchemy.engine.Engine [cached since 0.1131s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,064 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,064 INFO sqlalchemy.engine.Engine [cached since 0.1099s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:05,066 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,066 INFO sqlalchemy.engine.Engine [cached since 0.1156s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,067 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,067 INFO sqlalchemy.engine.Engine [cached since 0.1125s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
No exposure found for shocked factor: Interest_Rate (mapped to Interest Rate Beta)
2025-10-14 22:20:05,068 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,069 INFO sqlalchemy.engine.Engine [cached since 0.1184s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,070 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,070 INFO sqlalchemy.engine.Engine [cached since 0.1156s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
No exposure found for shocked factor: Interest_Rate (mapped to Interest Rate Beta)
2025-10-14 22:20:05,072 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,072 INFO sqlalchemy.engine.Engine [cached since 0.122s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,073 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,073 INFO sqlalchemy.engine.Engine [cached since 0.1189s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:05,075 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,075 INFO sqlalchemy.engine.Engine [cached since 0.1248s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,076 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,076 INFO sqlalchemy.engine.Engine [cached since 0.1218s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:05,078 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,078 INFO sqlalchemy.engine.Engine [cached since 0.1279s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,079 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,079 INFO sqlalchemy.engine.Engine [cached since 0.1248s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:05,080 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,080 INFO sqlalchemy.engine.Engine [cached since 0.1305s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,081 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,081 INFO sqlalchemy.engine.Engine [cached since 0.1271s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:05,083 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,083 INFO sqlalchemy.engine.Engine [cached since 0.1328s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,084 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,084 INFO sqlalchemy.engine.Engine [cached since 0.1294s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:05,085 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,085 INFO sqlalchemy.engine.Engine [cached since 0.135s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,086 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,086 INFO sqlalchemy.engine.Engine [cached since 0.1316s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:05,088 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,088 INFO sqlalchemy.engine.Engine [cached since 0.1377s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,089 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,089 INFO sqlalchemy.engine.Engine [cached since 0.1349s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:05,090 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,090 INFO sqlalchemy.engine.Engine [cached since 0.1407s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,090 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,090 INFO sqlalchemy.engine.Engine [cached since 0.1373s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:05,090 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,090 INFO sqlalchemy.engine.Engine [cached since 0.1429s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,090 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,090 INFO sqlalchemy.engine.Engine [cached since 0.1396s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:05,090 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,090 INFO sqlalchemy.engine.Engine [cached since 0.1452s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,096 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,096 INFO sqlalchemy.engine.Engine [cached since 0.1419s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:05,096 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,096 INFO sqlalchemy.engine.Engine [cached since 0.1475s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,096 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,096 INFO sqlalchemy.engine.Engine [cached since 0.1442s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:05,096 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,096 INFO sqlalchemy.engine.Engine [cached since 0.1498s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,096 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,096 INFO sqlalchemy.engine.Engine [cached since 0.1465s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:05,096 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,096 INFO sqlalchemy.engine.Engine [cached since 0.1521s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,103 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,103 INFO sqlalchemy.engine.Engine [cached since 0.1491s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:05,105 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,105 INFO sqlalchemy.engine.Engine [cached since 0.1554s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,107 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,107 INFO sqlalchemy.engine.Engine [cached since 0.1525s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:05,108 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,108 INFO sqlalchemy.engine.Engine [cached since 0.1584s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,109 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,109 INFO sqlalchemy.engine.Engine [cached since 0.1552s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:05,111 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,111 INFO sqlalchemy.engine.Engine [cached since 0.1609s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,112 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,112 INFO sqlalchemy.engine.Engine [cached since 0.1577s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:05,113 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,113 INFO sqlalchemy.engine.Engine [cached since 0.1634s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,114 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,114 INFO sqlalchemy.engine.Engine [cached since 0.1602s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:05,116 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,116 INFO sqlalchemy.engine.Engine [cached since 0.1659s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,117 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,117 INFO sqlalchemy.engine.Engine [cached since 0.1626s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:05,118 INFO sqlalchemy.engine.Engine SELECT portfolio_snapshots.id, portfolio_snapshots.portfolio_id, portfolio_snapshots.snapshot_date, portfolio_snapshots.total_value, portfolio_snapshots.cash_value, portfolio_snapshots.long_value, portfolio_snapshots.short_value, portfolio_snapshots.gross_exposure, portfolio_snapshots.net_exposure, portfolio_snapshots.daily_pnl, portfolio_snapshots.daily_return, portfolio_snapshots.cumulative_pnl, portfolio_snapshots.portfolio_delta, portfolio_snapshots.portfolio_gamma, portfolio_snapshots.portfolio_theta, portfolio_snapshots.portfolio_vega, portfolio_snapshots.num_positions, portfolio_snapshots.num_long_positions, portfolio_snapshots.num_short_positions, portfolio_snapshots.equity_balance, portfolio_snapshots.created_at 
FROM portfolio_snapshots 
WHERE portfolio_snapshots.portfolio_id = $1::UUID AND portfolio_snapshots.snapshot_date <= $2::DATE ORDER BY portfolio_snapshots.snapshot_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,118 INFO sqlalchemy.engine.Engine [cached since 0.1683s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 1)
2025-10-14 22:20:05,120 INFO sqlalchemy.engine.Engine SELECT factor_exposures.id, factor_exposures.portfolio_id, factor_exposures.factor_id, factor_exposures.calculation_date, factor_exposures.exposure_value, factor_exposures.exposure_dollar, factor_exposures.created_at, factor_exposures.updated_at, factor_definitions.id AS id_1, factor_definitions.name, factor_definitions.description, factor_definitions.factor_type, factor_definitions.calculation_method, factor_definitions.etf_proxy, factor_definitions.display_order, factor_definitions.is_active, factor_definitions.created_at AS created_at_1, factor_definitions.updated_at AS updated_at_1 
FROM factor_exposures JOIN factor_definitions ON factor_exposures.factor_id = factor_definitions.id 
WHERE factor_exposures.portfolio_id = $1::UUID AND factor_exposures.calculation_date <= $2::DATE ORDER BY factor_exposures.calculation_date DESC 
 LIMIT $3::INTEGER
2025-10-14 22:20:05,120 INFO sqlalchemy.engine.Engine [cached since 0.1658s ago] (UUID('1d8ddd95-3b45-0ac5-35bf-cf81af94a5fe'), datetime.date(2025, 10, 14), 50)
2025-10-14 22:20:05,122 INFO sqlalchemy.engine.Engine ROLLBACK
Traceback (most recent call last):
  File "C:\Users\BenBalbale\CascadeProjects\SigmaSight\backend\scripts\temp_run_stress_testing.py", line 71, in main
    print(f"\n\u2705 Stress test completed:")
  File "C:\Users\BenBalbale\AppData\Roaming\uv\python\cpython-3.11.13-windows-x86_64-none\Lib\encodings\cp1252.py", line 19, in encode
    return codecs.charmap_encode(input,self.errors,encoding_table)[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'charmap' codec can't encode character '\u2705' in position 2: character maps to <undefined>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\BenBalbale\CascadeProjects\SigmaSight\backend\scripts\temp_run_stress_testing.py", line 116, in <module>
    asyncio.run(main())
  File "C:\Users\BenBalbale\AppData\Roaming\uv\python\cpython-3.11.13-windows-x86_64-none\Lib\asyncio\runners.py", line 190, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "C:\Users\BenBalbale\AppData\Roaming\uv\python\cpython-3.11.13-windows-x86_64-none\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\BenBalbale\AppData\Roaming\uv\python\cpython-3.11.13-windows-x86_64-none\Lib\asyncio\base_events.py", line 654, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "C:\Users\BenBalbale\CascadeProjects\SigmaSight\backend\scripts\temp_run_stress_testing.py", line 96, in main
    print(f"\u274c ERROR: {e}")
  File "C:\Users\BenBalbale\AppData\Roaming\uv\python\cpython-3.11.13-windows-x86_64-none\Lib\encodings\cp1252.py", line 19, in encode
    return codecs.charmap_encode(input,self.errors,encoding_table)[0]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'charmap' codec can't encode character '\u274c' in position 0: character maps to <undefined>
