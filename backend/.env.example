# ==============================================================================
# REQUIRED CONFIGURATION
# ==============================================================================

# Database Configuration (REQUIRED)
# ------------------------------------------------------------------------------
# Core Database - For local development with Docker:
DATABASE_URL=postgresql+asyncpg://sigmasight:sigmasight_dev@localhost:5432/sigmasight_db

# AI Database - For RAG, memories, feedback (dual database architecture)
AI_DATABASE_URL=postgresql+asyncpg://sigmasight:sigmasight_dev@localhost:5432/sigmasight_ai_db

# JWT Configuration (REQUIRED)
# ------------------------------------------------------------------------------
# Generate with: openssl rand -hex 32
SECRET_KEY=your_secret_key_here_generate_with_openssl_rand_hex_32
ALGORITHM=HS256

# ==============================================================================
# AI CONFIGURATION
# ==============================================================================

# OpenAI Configuration (REQUIRED for AI Chat)
# ------------------------------------------------------------------------------
# Get API key at: https://platform.openai.com/api-keys
OPENAI_API_KEY=sk-...your_openai_api_key_here
OPENAI_ORG_ID=org-...your_org_id_here
OPENAI_MAX_COMPLETION_TOKENS=4096
OPENAI_MAX_TOOLS=10
OPENAI_RATE_LIMIT_PER_MINUTE=60
OPENAI_TIMEOUT_SECONDS=30

# Anthropic Configuration (OPTIONAL - backup/alternative)
# ------------------------------------------------------------------------------
# Get API key at: https://console.anthropic.com/
ANTHROPIC_API_KEY=sk-ant-...your_anthropic_api_key_here

# Agent Model Configuration
# ------------------------------------------------------------------------------
MODEL_DEFAULT=gpt-4o
MODEL_FALLBACK=gpt-4o-mini
AGENT_CACHE_TTL=600
SSE_HEARTBEAT_INTERVAL_MS=15000

# ==============================================================================
# MARKET DATA PROVIDERS
# ==============================================================================
# Provider Priority:
# 1. YFINANCE - PRIMARY (free, no key needed)
# 2. YAHOOQUERY - SECONDARY (free, no key needed)
# 3. POLYGON - Tertiary (options data)
# 4. FMP - Quaternary/fallback
# 5. FRED - Economic data

# POLYGON.IO
# Get free API key at: https://polygon.io/
POLYGON_API_KEY=your_polygon_api_key_here
POLYGON_PLAN=basic

# FMP (Financial Modeling Prep)
# Get free API key at: https://site.financialmodelingprep.com/developer/docs
FMP_API_KEY=your_fmp_api_key_here

# FRED (Federal Reserve Economic Data)
# Get free API key at: https://fred.stlouisfed.org/docs/api/api_key.html
FRED_API_KEY=your_fred_api_key_here

# ==============================================================================
# CLERK AUTHENTICATION & BILLING (Phase 2+)
# ==============================================================================
# Get these from Clerk Dashboard (https://dashboard.clerk.com)

# API Keys page:
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_test_...
CLERK_SECRET_KEY=sk_test_...

# Webhooks page (after creating endpoint):
CLERK_WEBHOOK_SECRET=whsec_...

# Domains page (Configure → Developers → Domain):
CLERK_DOMAIN=your-app.clerk.accounts.dev

# Your application's audience:
CLERK_AUDIENCE=sigmasight.io

# ==============================================================================
# APPLICATION SETTINGS
# ==============================================================================

# Environment
DEBUG=false
ENVIRONMENT=development
LOG_LEVEL=INFO

# User Onboarding
BETA_INVITE_CODE=2026-FOUNDERS-BETA
DETERMINISTIC_UUIDS=true

# ==============================================================================
# V2 BATCH ARCHITECTURE (Two-Cron, Instant Onboarding)
# ==============================================================================
# Master switch for V2 batch architecture
# Set to true to enable two-cron system with instant onboarding
BATCH_V2_ENABLED=false

# Timeout settings (seconds)
SYMBOL_BATCH_TIMEOUT_SECONDS=1500       # 25 min abort (target 15 min)
PORTFOLIO_REFRESH_TIMEOUT_SECONDS=1200  # 20 min abort (target 10 min)

# Concurrency limits (Railway-safe defaults)
PRICE_FETCH_CONCURRENCY=5               # Max concurrent price fetches
FACTOR_CALC_CONCURRENCY=10              # Max concurrent factor calculations
PORTFOLIO_REFRESH_CONCURRENCY=10        # Max concurrent portfolio refreshes
SYMBOL_ONBOARDING_CONCURRENCY=3         # Max concurrent symbol onboarding
SYMBOL_ONBOARDING_MAX_QUEUE=50          # Max pending onboarding jobs

# ==============================================================================
# NOTES FOR SETUP
# ==============================================================================
# 1. Minimal setup requires:
#    - DATABASE_URL (use default for Docker)
#    - AI_DATABASE_URL (use default for Docker)
#    - SECRET_KEY (generate a new one)
#    - OPENAI_API_KEY (for AI chat)
#
# 2. Market data works without keys (YFinance is free and automatic)
#
# 3. For full functionality add:
#    - POLYGON_API_KEY (options data)
#    - FMP_API_KEY (backup market data)
#    - FRED_API_KEY (economic data)
#
# 4. For Clerk auth (Phase 2+):
#    - All CLERK_* and NEXT_PUBLIC_CLERK_* variables
# ==============================================================================
